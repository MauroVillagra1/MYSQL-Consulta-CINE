SELECT p.PAIS, g.GENERO, COUNT(peli.CODPELI) AS CANT_PELICULAS, ROUND(SUM(est.RECAUDACION), 2) AS TOTAL_RECAUDADO
FROM cine.pais p
INNER JOIN cine.ciudad ciu ON p.CODPAIS = ciu.CODPAIS
INNER JOIN cine.estrenos est ON ciu.CODCIUDAD = est.CODCIUDAD
INNER JOIN cine.pelicula peli ON est.CODPELI = peli.CODPELI
INNER JOIN cine.genero g ON peli.CODGEN = g.CODGEN
WHERE g.GENERO IN ('animadas', 'terror', 'musical', 'negro')
GROUP BY p.PAIS, g.GENERO
HAVING SUM(est.RECAUDACION) > 19000000 AND COUNT(peli.CODPELI) >= 1
ORDER BY p.PAIS, g.GENERO, CANT_PELICULAS;